# Discord Remote Code Execution Proof of Concept

Note This is currently working as of 9/10/2024

    Found By Taylor Christian Newsome

This repository provides a proof of concept for a remote code execution (RCE) vulnerability in Discord. The provided Python script automates the setup of a Node.js RPC server and sends a request to demonstrate the exploit.
Repository Structure

    main.py: A Python script to automate the setup and interaction with the RPC server.
    server.js (generated by the script): The Node.js server file that handles RPC requests.

Setup and Usage
Prerequisites

    Python: Ensure Python 3.x is installed. You can download it from python.org.
    Node.js and npm: Ensure Node.js and npm are installed. You can download them from nodejs.org.

Install Python Dependencies

Install the required Python library using pip:

pip install requests

Running the Script

    Clone the repository:

    git clone https://github.com/SleepTheGod/DiscordRCE.git cd DiscordRCE

    Run the Python script to set up and start the RPC server, and send a request to demonstrate the exploit:

    python main.py

Script Explanation

The Python script performs the following steps:

    Setup Node.js Environment:
        Creates a directory named rpc-server.
        Initializes a new Node.js project and installs necessary dependencies (express and body-parser).

    Generate server.js:
        Writes the Node.js server code to server.js. This code sets up an RPC server that listens for requests on port 6463 and executes commands if the correct authorization token is provided.

    Start the RPC Server:
        Starts the Node.js server in the background.

    Send RPC Request:
        Sends a POST request to the RPC server to execute a specific command. This command demonstrates the RCE vulnerability by writing a message to a file.

Important Notes

Run the server with
node server.js

You should see the following output indicating that the server is running
RPC server listening at http://127.0.0.1:6463

Test the RPC Endpoint

Open another terminal and use curl to test the /rpc endpoint
curl -X POST http://127.0.0.1:6463/rpc \
-H "Content-Type: application/json" \
-H "Authorization: MTEzMjA0OTg4MDQxMjU5NDMyNg.ZuAKbA.arhOQxpLjiAXQGIah6HKbGv8rOw" \
-d '{"cmd":"EXECUTE_CODE","args":{"code":"echo \'Hello World\' > /tmp/testfile"},"nonce":"9414fdad-c891-44d0-ba5b-848f93f7ec0b"}'

Expected Output
{"status":"Code executed"}

Verify the Command Execution

Check if the command has been executed correctly by looking for the file /tmp/testfile and verifying its contents
cat /tmp/testfile

Expected Output
Hello World

Summary

    Code: Ensure server.js is correctly written and placed in the rpc-server directory.
    Dependencies: Make sure express and body-parser are installed.
    Server: Start the server and confirm it's listening on the correct port.
    Testing: Use curl to send a request and verify the response and side effects (e.g., file creation).

By following these steps, you should be able to confirm that the server.js code works as expected.
